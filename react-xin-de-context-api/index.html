<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.23.0"/><meta data-rh="true" name="description" content="原文： React&#x27;s ⚛️ new Context API  by kentcdodds 这不再是一个  实验性的 API ，并且它更符合工程化的理念，目前它已成为  React 一级棒的 API 。 ⚠️ ：大家可以通过  newsletter  获取我最新的资讯，我一般每两周通过邮件发送一次，大家可以通过自己的收件箱获取更多的内容。 React  中的  context API…"/><meta data-rh="true" name="keywords" content="React ⚛️ 新的 Context API, 枫上雾棋的 blog, 枫上雾棋, React, Context"/><meta data-rh="true" name="og:title" content="React ⚛️ 新的 Context API - 枫上雾棋的 blog"/><meta data-rh="true" name="og:description" content="原文： React&#x27;s ⚛️ new Context API  by kentcdodds 这不再是一个  实验性的 API ，并且它更符合工程化的理念，目前它已成为  React 一级棒的 API 。 ⚠️ ：大家可以通过  newsletter  获取我最新的资讯，我一般每两周通过邮件发送一次，大家可以通过自己的收件箱获取更多的内容。 React  中的  context API…"/><meta data-rh="true" name="og:type" content="article"/><meta data-rh="true" name="og:url" content="https://blog.fengshangwuqi.com/react-xin-de-context-api/"/><meta data-rh="true" name="og:image" content="https://blog.fengshangwuqi.com/static/df2330ecd6a0ee9524f29b5d84c43b84/a3486/react-context.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:title" content="React ⚛️ 新的 Context API - 枫上雾棋的 blog"/><meta data-rh="true" name="twitter:description" content="原文： React&#x27;s ⚛️ new Context API  by kentcdodds 这不再是一个  实验性的 API ，并且它更符合工程化的理念，目前它已成为  React 一级棒的 API 。 ⚠️ ：大家可以通过  newsletter  获取我最新的资讯，我一般每两周通过邮件发送一次，大家可以通过自己的收件箱获取更多的内容。 React  中的  context API…"/><meta data-rh="true" name="twitter:image" content="https://blog.fengshangwuqi.com/static/df2330ecd6a0ee9524f29b5d84c43b84/a3486/react-context.png"/><meta data-rh="true" name="twitter:creator" content="@fengshangwuqi"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><title data-rh="true">React ⚛️ 新的 Context API - 枫上雾棋的 blog</title><link data-rh="true" rel="canonical" href="https://blog.fengshangwuqi.com/react-xin-de-context-api/"/><script data-rh="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://blog.fengshangwuqi.com/react-xin-de-context-api/","name":"React ⚛️ 新的 Context API - 枫上雾棋的 blog"},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://blog.fengshangwuqi.com/react-xin-de-context-api/","name":"React ⚛️ 新的 Context API - 枫上雾棋的 blog","headline":"React ⚛️ 新的 Context API - 枫上雾棋的 blog","image":"https://blog.fengshangwuqi.com/static/df2330ecd6a0ee9524f29b5d84c43b84/a3486/react-context.png","description":"原文： React's ⚛️ new Context API  by kentcdodds 这不再是一个  实验性的 API ，并且它更符合工程化的理念，目前它已成为  React 一级棒的 API 。 ⚠️ ：大家可以通过  newsletter  获取我最新的资讯，我一般每两周通过邮件发送一次，大家可以通过自己的收件箱获取更多的内容。 React  中的  context API…","author":{"@type":"Person","name":"枫上雾棋"},"publisher":{"@type":"Person","name":"枫上雾棋"},"datePublished":"2018-02-01"}]</script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="alternate" type="application/rss+xml" title="fengshangwuqi&#x27;s blog RSS Feed" href="/rss.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global 1xs1vri">0 html{line-height:1.15;-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%;}0 body{margin:0;}0 main{display:block;}0 h1{font-size:2em;margin:0.67em 0;}0 hr{box-sizing:content-box;height:0;overflow:visible;}0 pre{font-family:monospace,monospace;font-size:1em;}0 a{background-color:transparent;}0 abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;}0 b,0 strong{font-weight:bolder;}0 code,0 kbd,0 samp{font-family:monospace,monospace;font-size:1em;}0 small{font-size:80%;}0 sub,0 sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}0 sub{bottom:-0.25em;}0 sup{top:-0.5em;}0 img{border-style:none;}0 button,0 input,0 optgroup,0 select,0 textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}0 button,0 input{overflow:visible;}0 button,0 select{text-transform:none;}0 button,0 html [type="button"],0 [type="reset"],0 [type="submit"]{-webkit-appearance:button;}0 button::-moz-focus-inner,0 [type="button"]::-moz-focus-inner,0 [type="reset"]::-moz-focus-inner,0 [type="submit"]::-moz-focus-inner{border-style:none;padding:0;}0 button:-moz-focusring,0 [type="button"]:-moz-focusring,0 [type="reset"]:-moz-focusring,0 [type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}0 fieldset{padding:0.35em 0.625em 0.75em;}0 legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}0 progress{vertical-align:baseline;}0 textarea{overflow:auto;}0 [type="checkbox"],0 [type="radio"]{box-sizing:border-box;padding:0;}0 [type="number"]::-webkit-inner-spin-button,0 [type="number"]::-webkit-outer-spin-button{height:auto;}0 [type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}0 [type="search"]::-webkit-search-decoration{-webkit-appearance:none;}0::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}0 details{display:block;}0 summary{display:-webkit-box;display:-webkit-list-item;display:-ms-list-itembox;display:list-item;}0 template{display:none;}0 [hidden]{display:none;}1 abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}</style><style data-emotion="css-global 1otop4o">body{margin:0;min-width:320px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Helvetica,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",SimSun,sans-serif;color:rgba(0,0,0,0.85);background:#fff;}a{color:#3c2584;-webkit-text-decoration:none;text-decoration:none;}h1,h2,h3,h4,h5,h6{margin:0;}ul,li{margin:0;padding:0;}dialog{padding:0;width:100%;max-width:47.375rem;border-radius:16px;border:0;overflow:hidden;}dialog::backdrop{background-color:rgba(0,0,0,0.25);}input::-webkit-input-placeholder{color:#cbd5e0;}input::-moz-placeholder{color:#cbd5e0;}input:-ms-input-placeholder{color:#cbd5e0;}input::placeholder{color:#cbd5e0;}svg{fill:#3c2584;vertical-align:middle;}</style><style data-emotion="css-global 1thn7hv">html{font-size:1rem;}</style><style data-emotion="css bbj177">.css-bbj177{border-top-width:8px;border-top-style:solid;border-top-color:#3c2584;}</style><div class="css-bbj177"></div><style data-emotion="css xu7xrg">.css-xu7xrg{position:relative;margin:0 auto;max-width:1200px;}@media (min-width: 1024px){.css-xu7xrg{margin:0 auto 4rem;}}</style><div class="css-xu7xrg"><style data-emotion="css-global gx5x2v">.gatsby-highlight{margin-top:25px;margin-right:25px;margin-bottom:25px;margin-left:25px;padding-top:25px;padding-right:25px;padding-bottom:25px;padding-left:25px;border-radius:8px;background:#282a36;overflow:scroll;}.gatsby-highlight pre[class*="language-"],.gatsby-highlight code[class*="language-"]{margin-top:0;margin-right:0;margin-bottom:0;margin-left:0;line-height:1.45;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:0.85px;color:#fff;}.gatsby-highlight-code-line{margin-top:0;margin-right:-25px;margin-bottom:0;margin-left:-25px;padding-top:0.125rem;padding-right:25px;padding-bottom:0.125rem;padding-left:25px;display:block;background:#2e3440;}.token.comment{color:#6272a4;}.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#bd93f9;}.token.class-name,.token.attr-name,.token.rule,.token.selector{color:#50fa7b;}.token.function,.token.property,.token.operator{color:#66d9ef;}.token.punctuation{color:#fff;}a.vglnk,.token.url,.token.attr-value,.token.string,.token.string a,.token.char,.token.builtin,.token.inserted,.token.entity{color:#f1fa8c;}.token.regex,.token.keyword,.token.tag,.token.important,.token.variable{color:#ff79c6;}.token.important,.token.bold{font-weight:bold;}.token.italic{font-style:italic;}.token.entity{cursor:help;}.namespace{opacity:0.7;}</style><style data-emotion="css 69i1ev">.css-69i1ev{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-69i1ev"><style data-emotion="css 12j8t3d">.css-12j8t3d{height:60px;}@media (min-width: 640px){.css-12j8t3d{height:80px;}}</style><style data-emotion="css t69gxk">.css-t69gxk{height:50px;list-style:none;overflow:hidden;height:60px;}@media (min-width: 640px){.css-t69gxk{height:80px;}}</style><ul class="css-t69gxk"><style data-emotion="css 1uxqxt6">.css-1uxqxt6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;padding:0 0.5rem;float:left;}@media (min-width: 640px){.css-1uxqxt6{padding:0 1rem;}}</style><li class="css-1uxqxt6"><style data-emotion="css 9ybir">.css-9ybir{display:none;font-size:1.5rem;}@media (min-width: 1024px){.css-9ybir{font-size:1.875rem;}}</style><a class="css-9ybir" href="/">枫上雾棋的日志</a></li></ul><style data-emotion="css axo7pa">.css-axo7pa{display:block;height:60px;}@media (min-width: 640px){.css-axo7pa{display:block;height:80px;}}</style><style data-emotion="css 159pr1g">.css-159pr1g{height:50px;list-style:none;overflow:hidden;display:block;height:60px;}@media (min-width: 640px){.css-159pr1g{display:block;height:80px;}}</style><ul class="css-159pr1g"><li class="css-1uxqxt6"><a href="/archive">归档</a></li><li class="css-1uxqxt6"><a href="/">最新</a></li><li class="css-1uxqxt6"><a href="/rss.xml" target="_blank" rel="noopener noreferrer">RSS</a></li><li class="css-1uxqxt6"><a href="https://github.com/FengShangWuQi/fengshangwuqi.github.io/releases" target="_blank" rel="noopener noreferrer"><style data-emotion="css dytt20">.css-dytt20{position:relative;border-width:1px;border-style:solid;border-color:#3c2584;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;-user-select:none;padding:0.25rem 0.75rem;border-radius:4px;outline:0;cursor:pointer;-webkit-transition:all 0.2s;transition:all 0.2s;color:#fff;background:#3c2584;}.css-dytt20:hover{border-width:1px;border-style:solid;border-color:#4e30ac;background:#4e30ac;}</style><button type="button" class="css-dytt20">订阅</button></a></li></ul></div><style data-emotion="css njb4cg">.css-njb4cg{position:relative;height:400px;width:100%;}</style><div class="css-njb4cg"><style data-emotion="css f8znwd">.css-f8znwd{top:0;right:0;bottom:0;left:0;position:absolute;background:transparent;box-shadow:inset 120px 100px 500px 50px rgba(0, 0, 0, 0.75);z-index:10;}</style><div class="css-f8znwd"></div><style data-emotion="css 13udsys">.css-13udsys{height:100%;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper css-13udsys"><div aria-hidden="true" style="padding-top:75%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACl0lEQVQozzVS2Y6cMBDk/79ro90Zbny1bWwwA4bhNjBkN3mJ2CRSPbSqW+qqUnmKc6OL17b9/vqlpcIpzrl0y/rzPAnCcRgXudqcW6b5/u5HQVwV5bHtpij9e+A1pnpaO4/D9HxqKddpcvP82ve2aUql12k+nPt8vRpj2rpxy/J1nsfmjNbTMHg5F1pIgrDiopC5oCwHHoeJZFww0EKQDKdRkgPXQiohwyCWDDgFzsCTDNyy9taSFOUgKCL76iSXURDhJMu5GPvh9n5HSRaHcWdbgmlwC5Io8f3Qm8fxte+KC4aplvnutt05gnASpVrmx7bXprq930lGbN0c+x6HSeTHSsihH7x1HkutFZdj1y3DeB670boxZuqHfV3XaVJC9l23jOPXedrq8SjNdJ0dr23zSHa55YQJSnPg18A4/iYJwlmckgxfPGVxGJMUMUyUEGmSUYQ9wYAizAnTQm7rkiUZ+kbX2Koof7x9JGEClI19f//wbx++fw9t3QBlt3ffywGAUqP0ebyGrqOIcArPtv08TyXk/yBc33U4RRTTrrG7WwkiQMCrlG6rx9T3yzjmXHR1M/X94dzT2kKp8fmch/Hfytq/QRitq7Kcx9Hj+LL6FwI4w6QQUjC47GAiKAgKoR+lUcouUSzyo+AeRkF8fRaENsZ0TY3STFDIgbt5zoXM4pQT2rdt37WRH0V+WMh8naYszvx7kEbp1A/eoyiXcSiVkgyUEMt4idRclLlq6/rYXFUUlS5qUx3b9rw6q2pj3Lys8+QNrW2MAUJtVbV1fTVcSC1lW9d929qqEhTqsrSP2j4eQJjRujZV2zSCgccpk4xTTABTBZxkGAhFCVIAQGgUxjhFQKgE4X8EoR9nCboa7kc/3m5/ABaLDMRXDSSYAAAAAElFTkSuQmCC" alt=""/><picture><source type="image/webp" data-srcset="/static/df2330ecd6a0ee9524f29b5d84c43b84/66907/react-context.webp 750w,/static/df2330ecd6a0ee9524f29b5d84c43b84/27610/react-context.webp 1080w,/static/df2330ecd6a0ee9524f29b5d84c43b84/c3710/react-context.webp 1200w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/df2330ecd6a0ee9524f29b5d84c43b84/a3486/react-context.png" data-srcset="/static/df2330ecd6a0ee9524f29b5d84c43b84/76a4f/react-context.png 750w,/static/df2330ecd6a0ee9524f29b5d84c43b84/a902f/react-context.png 1080w,/static/df2330ecd6a0ee9524f29b5d84c43b84/a3486/react-context.png 1200w" alt="React ⚛️ 新的 Context API"/></picture><noscript><picture><source type="image/webp" srcSet="/static/df2330ecd6a0ee9524f29b5d84c43b84/66907/react-context.webp 750w,/static/df2330ecd6a0ee9524f29b5d84c43b84/27610/react-context.webp 1080w,/static/df2330ecd6a0ee9524f29b5d84c43b84/c3710/react-context.webp 1200w" sizes="100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/df2330ecd6a0ee9524f29b5d84c43b84/a3486/react-context.png" srcSet="/static/df2330ecd6a0ee9524f29b5d84c43b84/76a4f/react-context.png 750w,/static/df2330ecd6a0ee9524f29b5d84c43b84/a902f/react-context.png 1080w,/static/df2330ecd6a0ee9524f29b5d84c43b84/a3486/react-context.png 1200w" alt="React ⚛️ 新的 Context API"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></div><style data-emotion="css 1325usx">.css-1325usx{padding:0.25rem 1.5rem 3.5rem;overflow:hidden;box-shadow:inset 0 0 30px rgba(0,0,0,0.1);}@media (min-width: 1024px){.css-1325usx{padding:0.25rem 2rem 3.5rem;}}</style><div class="css-1325usx"><style data-emotion="css 1d53jwi">.css-1d53jwi{line-height:1.675;}.css-1d53jwi h1,.css-1d53jwi h2{border-bottom-width:3px;border-bottom-style:solid;border-bottom-color:#3c2584;padding-bottom:0.5rem;font-weight:normal;}.css-1d53jwi h1{font-size:24px;margin-top:2.5rem;margin-right:0;margin-bottom:0.5rem;margin-left:0;}@media (min-width: 640px){.css-1d53jwi h1{font-size:calc(24px + (8) * (100vw - 640px) / (640));}}@media (min-width: 1280px){.css-1d53jwi h1{font-size:32px;}}.css-1d53jwi h2{font-size:20px;margin-top:2rem;margin-right:0;margin-bottom:0.25rem;margin-left:0;}@media (min-width: 640px){.css-1d53jwi h2{font-size:calc(20px + (5) * (100vw - 640px) / (640));}}@media (min-width: 1280px){.css-1d53jwi h2{font-size:25px;}}.css-1d53jwi h3{font-size:18px;margin-top:2.5rem;margin-right:0;margin-bottom:0;margin-left:0;-webkit-box-decoration-break:clone;box-decoration-break:clone;}@media (min-width: 640px){.css-1d53jwi h3{font-size:calc(18px + (4) * (100vw - 640px) / (640));}}@media (min-width: 1280px){.css-1d53jwi h3{font-size:22px;}}.css-1d53jwi h2+h3{margin-top:1.5rem;}.css-1d53jwi p{font-size:15px;margin-top:1.5rem;margin-right:0;margin-bottom:0;margin-left:0;}@media (min-width: 640px){.css-1d53jwi p{font-size:calc(15px + (1) * (100vw - 640px) / (640));}}@media (min-width: 1280px){.css-1d53jwi p{font-size:16px;}}.css-1d53jwi h3+p{margin-top:0.75rem;}.css-1d53jwi ul{margin-top:1.5rem;margin-right:2rem;margin-bottom:1.5rem;margin-left:2rem;}.css-1d53jwi li>ol,.css-1d53jwi li>ul{margin-top:1.5rem;margin-right:2rem;margin-bottom:1.5rem;margin-left:2rem;}.css-1d53jwi img{display:block;margin:0 auto;max-width:600px;}.css-1d53jwi blockquote{margin-top:1.5rem;margin-right:0;margin-bottom:0;margin-left:0;padding-top:1.25rem;padding-right:1rem;padding-bottom:1.25rem;padding-left:1rem;border-left-width:9px;border-left-style:solid;border-left-color:#ffe564;background:rgba(255,229,100,0.3);overflow:auto;}.css-1d53jwi blockquote p:first-of-type{margin:0;}.css-1d53jwi a:not(.anchor):not(.gatsby-resp-image-link):not(.vglnk){border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#ddd;background:rgba(221,221,221,0.3);}.css-1d53jwi .twitter-content{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}</style><div class="css-1d53jwi"><h1>React ⚛️ 新的 Context API</h1><style data-emotion="css 1gammwy">.css-1gammwy{margin-top:5px;}</style><div class="css-1gammwy"><style data-emotion="css 6ptu4e">.css-6ptu4e{margin-right:4px;font-weight:bold;}</style><style data-emotion="css eoc4g">.css-eoc4g{padding-top:2px;padding-right:5px;padding-bottom:2px;padding-left:5px;display:inline-block;font-size:0.75rem;border-radius:4px;color:#5fd9fb;background:#1a1c22;margin-right:4px;font-weight:bold;}</style><div class="css-eoc4g">#<!-- -->React</div><style data-emotion="css 1766p1o">.css-1766p1o{padding-top:2px;padding-right:5px;padding-bottom:2px;padding-left:5px;display:inline-block;font-size:0.75rem;border-radius:4px;color:#606570;background:#d6d9e0;margin-right:4px;font-weight:bold;}</style><div class="css-1766p1o">#<!-- -->Context</div></div><p>原文：<a href="https://blog.kentcdodds.com/reacts-%EF%B8%8F-new-context-api-70c9fe01596b" target="_blank" rel="noopener noreferrer">React’s ⚛️ new Context API</a> by kentcdodds</p><p>这不再是一个 <strong>实验性的 API</strong>，并且它更符合工程化的理念，目前它已成为 <strong>React 一级棒的 API</strong>。</p><blockquote><p>⚠️ ：大家可以通过 <a href="https://tinyletter.com/kentcdodds" target="_blank" rel="noopener noreferrer">newsletter</a> 获取我最新的资讯，我一般每两周通过邮件发送一次，大家可以通过自己的收件箱获取更多的内容。</p></blockquote><p><strong>React</strong> 中的 <strong>context API</strong> 相信大家都知道吧，可能跟大伙一样，当看到 <strong>React</strong> 的官方文档是这样时，都不敢直接使用它。</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:600px">
      <a class="gatsby-resp-image-link" href="/static/72ce00fb7be757daefb02c50ffd36bbe/f8915/react-context-API.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:80.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEB0lEQVQ4y52TW0xcVRSGd51Ea4olxjZQEGyhA0wxShG0oqW+SB/1QWWMNcQHo0mjpGosJTMdLk1oAUmtaWpDWkJBECNDKYgPQK1gGVrCpUYslGEuHZjLOXPmUhjOnNv+zTkgIT66kj9rZe+Vb//7RjDzF5m60f/y6G/tH3bfGii9Nfy78d7UtPGO7Y5xfGzcODMzY5yYmDCOjo4abTabcWxD4+PjxpGRUePQ4GDpzaGhY339A/tv2+4SAoA47/15PRhYwH23HXaHE8EIBx/jx7Lfi2AwCJZlwbIMotEoIpEwwuHweg6FsOh0Ym5hAdNTU5UqSwNeuHS5u/PnXrS1dwqtHR3ylY52ua2rS27t7JSvtlyTW1rb5O6eXtl6vVfuvdEv9/X/Kvf1D2hq6/xJuHz1Ghobm0wasOSKjSSmZFgTDxQgIbdQSk7PomnPZdPk1EyalJKh5bR9Bro7eS9NTs2iKenP02xDPtVnv0iTUzJpappeTtqzD089nWRO1ecT0nPTQfSGPGtO7ks4WPCa9E3TBdrc3IJz9U2oO9uImto6VFWdQU1tA2prTqG26hOcPVeP+obzqK9voue/vSiXvFWKpNQMs/6Fw4R0DDvJfkOeNTPnIIqOHJW8Ph+VRBHRaASx2CpCoRACAT+CXAis7y4izDAUmQcFIEmSmuTjFRZsT3jGTMhOQn4YXNwA5uHV4jclr9dHFUXWLkM9fC7EgWXD8Pvm4HP/Ap6PQg21R5ZlDfjVSRO2J+wyE5JISMcWYNGREolhWUop1Zytrq6CYRh4lnxYXrqPZUcXAr6/sewNwOv1wul0acCTlRY8vmPD4X+BnqUlyvM8/H4/IpGI6gKSrEAUViDE7BCFKARBQjweRyy2pgG/PnUaT/y75Z4/vCQrN9+qP5CP1984Kvn9ASpJkuYwFovhoceD+QcOOBan4XP+iIB/Dp4lPwJMAOria2trmsMnd+42E90uQkzfDZBn9+ZY96RnI6/wsBQIMBSg6na0Bx3kOLjdD8GwHEQxBiG+Bj4ehyAImw7Lv6wA0e0wEzXUx/j2O+93l37wET49fkJkg0GF53mFYRglEokooigq8big8DGfwscYhVIolFJNoIoCQLz4fTMKDxWbjn38xTqQ47h+bAlRFKFovcCjRytgGBacfwSr4cmtbVgVgOiKoNULCw+qN7/e5OTkJbvdzs3OzrocDofH5XJ5nE6nJrV2u90et3vZ43IvedR5dXx+ft4zNj3vGbk97XYsOtih4aHPNKDBYNARQtIJIa8QQg79TxUQQpIaGuq0YyR1dXXbysvLdWVlZTqTyaSrqqrSWSyWzbyu0xuy6Kqrq3Wfl5frit89ocsvek9XWVH5WO2Z2m2qw38AJVlMlAe9lZ0AAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="API" title="API" src="/static/72ce00fb7be757daefb02c50ffd36bbe/0a47e/react-context-API.png" srcSet="/static/72ce00fb7be757daefb02c50ffd36bbe/8a4e8/react-context-API.png 150w,/static/72ce00fb7be757daefb02c50ffd36bbe/5a46d/react-context-API.png 300w,/static/72ce00fb7be757daefb02c50ffd36bbe/0a47e/react-context-API.png 600w,/static/72ce00fb7be757daefb02c50ffd36bbe/f8915/react-context-API.png 748w" sizes="(max-width: 600px) 100vw, 600px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>第一条搜索结果显示的就是 <a href="https://reactjs.org/docs/context.html#why-not-to-use-context" target="_blank" rel="noopener noreferrer">为什么不建议使用 context</a>，让大家瞬间产生忧虑，该章节是这么描述 <strong>context</strong> 的：</p><blockquote><p>如果你想让你的应用更加稳定，就别使用 <strong>context</strong>，因为这是一个 <strong>实验性的 API</strong>，在未来的 <strong>React</strong> 版本中可能会发生改变。</p></blockquote><p>⚠️ 注意，这里的改变包含中断，终止，不再使用。</p><h2 id="那么为什么还要使用-context-呢" style="position:relative"><a href="#%E9%82%A3%E4%B9%88%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%98%E8%A6%81%E4%BD%BF%E7%94%A8-context-%E5%91%A2" aria-label="那么为什么还要使用 context 呢 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>那么，为什么还要使用 context 呢</h2><p>你曾经历过尝试在一个层级很深的组件中获取最外层组件的 <strong>state</strong> 的痛苦么，这种痛苦叫 <strong>prop drilling</strong>，可谓让人接近崩溃的。当遇到这种情形时，你肯定不会喜欢用 <strong>props</strong> 来传递数据，因为如果中间有个组件发生改变，这个代价将是几何。</p><p>实际上，你可以通过使用常规的 <strong>JavaScript module</strong> 来规避以上的问题，将数据存在某个 <strong>module</strong> 中，就可以实现在任何地方访问和导入了，但这么做会让更新变得困难（你必须实现一个 <strong>event</strong> 在数据更新时触发，通知用户数据发生改变），并且，服务端渲染对 <strong>module</strong> 也会有 <a href="https://stackoverflow.com/questions/40935571/why-singleton-store-in-flux-can-cause-issue-for-server-side-rendering/40974748#40974748" target="_blank" rel="noopener noreferrer">影响</a>。</p><p>因此，像 <a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer">redux</a> 这样的负责 <strong>状态管理</strong> 的第三方库进入了大家的视野。它允许你在任何地方从 <strong>store</strong> 获取数据，你需要做的只是使用 <strong>Provider</strong> 包装一下，然后就可以神奇地在 <strong>connected</strong> 的组件中轻松地获取想要的数据了。</p><p>然而，如果我告诉你 <strong>Provider</strong> 就是在使用 <strong>context</strong> 这个 <strong>实验性 API</strong> 呢？事实确实是这样的！<strong>provider</strong> 组件将数据存进 <strong>context</strong> 中，<strong>connect</strong> 高阶组件从 <strong>context</strong> 获取数据，所以，<strong>redux</strong> 事实并不允许你的数据在任何地方访问。</p><p>那么，为什么还要使用 <strong>context</strong> 呢？可能是大家已经深深地爱上它了吧！即使你没有直接使用 <strong>context</strong>，你的应用程序也会通过引用像 <a href="https://github.com/reactjs/react-redux/blob/76dd7faa90981dd2f9efa76f3e2f26ecf2c12cf7/src/components/connectAdvanced.js#L136-L143" target="_blank" rel="noopener noreferrer">react-redux</a>， <a href="https://github.com/mobxjs/mobx-react/blob/dc249910c74c1b2e988a879be07f10aeaea90936/src/Provider.js#L19-L34" target="_blank" rel="noopener noreferrer">MobX-react</a>， <a href="https://github.com/ReactTraining/react-router/blob/e6f9017c947b3ae49affa24cc320d0a86f765b55/packages/react-router/modules/Router.js#L23-L34" target="_blank" rel="noopener noreferrer">react-router</a>， <a href="https://github.com/paypal/glamorous/blob/7468bfc76f46783cac841e20973ed119c771f3b7/src/theme-provider.js#L33-L37" target="_blank" rel="noopener noreferrer">glamorous</a> 这样的第三方库间接用到它。</p><h2 id="context-重生啦" style="position:relative"><a href="#context-%E9%87%8D%E7%94%9F%E5%95%A6" aria-label="context 重生啦 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Context 重生啦</h2><p>现在清楚了，我们是如此地热爱 <strong>context</strong>，但官方文档的警告依然还在：在 <strong>React</strong> 的未来版本中，可能不再使用它，好消息是，<strong>context</strong> 要正式跟大家打招呼了，而且大家可能会比之前更爱它。</p><p>一个月前，<strong>React</strong> 团队 从 <a href="https://github.com/yarnpkg/rfcs" target="_blank" rel="noopener noreferrer">yarn</a>，<a href="https://github.com/rust-lang/rfcs" target="_blank" rel="noopener noreferrer">rust</a> 和 <a href="https://github.com/emberjs/rfcs" target="_blank" rel="noopener noreferrer">Ember</a> 的 <strong>rfcs 仓库</strong> 受到启发，建立了一个自己的 <a href="https://github.com/reactjs/rfcs" target="_blank" rel="noopener noreferrer">rfcs</a> 仓库。仓库第一个 <strong>PR</strong> 来自 <a href="https://twitter.com/acdlite" target="_blank" rel="noopener noreferrer">Andrew Clark</a>（React 团队核心成员），<strong>PR</strong> 标题为 <a href="https://github.com/reactjs/rfcs/pull/2" target="_blank" rel="noopener noreferrer">New version of context</a>，其中 <strong>Andrew Clark</strong> 概述了未来新版本的 <strong>context</strong> 是怎样的，之后还存在一些有趣的讨论，几天后，<strong>Andrew Clark</strong> 就向 <strong>React</strong> 仓库提了一个 <a href="https://github.com/facebook/react/pull/11818" target="_blank" rel="noopener noreferrer">New context API</a> 的 <strong>PR</strong>。</p><p>那么，到底有什么改变呢？据肉眼估计，新的 <strong>API</strong> 与之前的 <strong>API</strong> 存在百万级别的差异，下面是一个简单的 <a href="https://codesandbox.io/s/n4r0qq898j?from-embed" target="_blank" rel="noopener noreferrer">示例</a>：</p><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">&quot;light&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ThemeProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">theme</span><span class="token operator">:</span> <span class="token string">&quot;light&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ThemeContext<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">ThemeConsumer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ThemeContext<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeProvider</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>val<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeProvider</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><blockquote><p>你可能注意到示例中使用到一个 <strong>render prop</strong>，但实际上并没有任何关于需要使用 <strong>render prop</strong> 的 <strong>context API</strong>，你可以使用 <strong>context API</strong> 轻松实现高阶组件或其他功能。</p></blockquote><p>新的 <strong>context API</strong> 主要由以下三部分组成：</p><ul><li><strong>React.createContext</strong>：用于传递初始值，返回一个包含 <strong>provider</strong> 和 <strong>consumer</strong> 的对象；</li><li><strong>provide</strong>：放置在组件树中的较高层，并可以接收任何值；</li><li><strong>consume</strong>：在 <strong>provider</strong> 之后任何地方使用，并传递一个返回 <strong>JSX</strong> 的函数（这有点像 <strong>render prop</strong> 组件，但 <strong>consume</strong> 不是组件）；</li></ul><p>我对这个 <strong>API</strong> 充满了期待，<strong>React</strong> 团队也将会移除 <strong>context 是实验性 API</strong> 的警告，因为它现在是框架 <a href="https://twitter.com/acdlite/status/957445801302618112" target="_blank" rel="noopener noreferrer">一级棒的特性</a>，这也意味着大家将不再那么担心使用 <strong>context</strong> 来解决应用中 <strong>prop-drilling</strong> 的问题了，对 <strong>Redux</strong> 不再那么依赖，对 <strong>React</strong> 也将更加喜欢。</p><p>这是我最近的推文：</p><div class="twitter-content"><blockquote class="twitter-tweet" data-lang="zh-cn"><p lang="en" dir="ltr">People&#x27;s fixation with keeping render methods small aggravates the &quot;prop drilling problem&quot; which makes folks want redux to help alleviate it</p>— Kent C. Dodds (@kentcdodds) <a href="https://twitter.com/kentcdodds/status/911276059051438082?ref_src=twsrc%5Etfw">2017年9月22日</a></blockquote></div><p>我认为如果我们不过早或武断地去破坏 <strong>render</strong> 方法，我们可能就不会那么痛苦，即便最终我们实在没有办法避免，我们也可以通过核心的 <strong>React API</strong> 来解决。</p><h2 id="context-实践" style="position:relative"><a href="#context-%E5%AE%9E%E8%B7%B5" aria-label="context 实践 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Context 实践</h2><p>我看到了一个关于 <strong>context API</strong>（或普通的 <strong>render prop pattern</strong>）的问题很多次，就是如何组合 <strong>providers</strong> 和 <strong>consumers</strong>，当在一个 <strong>render</strong> 方法中把一堆 <strong>render prop</strong> 组件放在一起时，就会像这样 <a href="https://twitter.com/acdlite/status/955955121979969537" target="_blank" rel="noopener noreferrer">嵌套</a>。</p><div class="twitter-content"><blockquote class="twitter-tweet" data-conversation="none" data-lang="zh-cn"><p lang="en" dir="ltr">I mean come on (screen shot of actual code I’m playing with right now) <a href="https://t.co/Ucc8gaxPMp">pic.twitter.com/Ucc8gaxPMp</a></p>— Andrew Clark (@acdlite) <a href="https://twitter.com/acdlite/status/955955121979969537?ref_src=twsrc%5Etfw">2018年1月24日</a></blockquote></div><p>那么，我们可以做点什么来避免呢？其实，个人觉得没有那么糟糕，如果你觉得这样并不好，那么可以使用常规的 <strong>utility</strong> 函数/组件来解决，下面是一个示例：</p><div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">&quot;light&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ThemeProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">/* code */</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">ThemeConsumer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ThemeContext<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> LanguageContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">&quot;en&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">LanguageProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">/* code */</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">LanguageConsumer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> LanguageContext<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">AppProviders</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">LanguageProvider</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeProvider</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeProvider</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">LanguageProvider</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">ThemeAndLanguageConsumer</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">LanguageConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token parameter">language</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token parameter">theme</span> <span class="token operator">=&gt;</span> <span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">{</span> language<span class="token punctuation">,</span> theme <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">LanguageConsumer</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AppProviders</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeAndLanguageConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> theme<span class="token punctuation">,</span> language <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span><span class="token plain-text"> and </span><span class="token punctuation">{</span>language<span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeAndLanguageConsumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">AppProviders</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>目标是使用常见的案例，结合特殊功能的函数/组件，使案例更加工程化。</p><p>除此之外，大家还可以参考 <a href="https://medium.com/@jmeas" target="_blank" rel="noopener noreferrer">jmeas</a> 的 <a href="https://codesandbox.io/s/92pj14134y?from-embed" target="_blank" rel="noopener noreferrer">react-composer</a>。</p><p>在这里需要提及的是，在实践中，并不建议大家嵌套渲染 <strong>props components</strong>，无论什么时候，都可以选择创建多个简单易用的组件，然后组合使用。</p><h2 id="总结" style="position:relative"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h2><p>正如上面所说的，我对这个 <strong>API</strong> 充满了期待。目前暂未发布，但应该会包含在下一个 <strong>minor</strong> 版本中。不同担心，之前的 <strong>API</strong> 会继续正常工作，直到下一个 <strong>major</strong> 版本发布，所以，每个人都有时间迁移，而且不用过于担心，<strong>React</strong> 团队在 <strong>Facebook</strong> 有超过 <strong>50,000</strong> 个 <strong>React components</strong> 需要维护，所以，将来很有可能会发布一个 <strong>codemod</strong> 去自动更新大多数人的代码（就像以往一样）。</p><p>最后再表达一下我对此的兴奋。</p><div class="twitter-content"><blockquote class="twitter-tweet" data-conversation="none" data-lang="zh-cn"><p lang="en" dir="ltr">That&#x27;s one thing that excites me about the API improvement (in addition to other changes coming). So many new patterns will emerge out of this stuff. Ways of doing things we haven&#x27;t considered before!!</p>— Kent C. Dodds (@kentcdodds) <a href="https://twitter.com/kentcdodds/status/956675313966239745?ref_src=twsrc%5Etfw">2018年1月25日</a></blockquote></div></div></div><style data-emotion="css 126avwq">.css-126avwq{margin-top:3rem;margin-right:auto;margin-bottom:0;margin-left:auto;padding:0 1rem;max-width:700px;}@media (min-width: 640px){.css-126avwq{padding:0;}}</style><div class="css-126avwq"><div id="disqus_thread"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=null"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'null', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/react-xin-de-context-api/";window.___webpackCompilationHash="a97a1afd049eefe1ea64";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-0a7e28a325a2afe1e330.js"],"app":["/app-c4b088bac8b0e0c320b8.js"]};/*]]>*/</script><script src="/polyfill-0a7e28a325a2afe1e330.js" nomodule=""></script><script src="/app-c4b088bac8b0e0c320b8.js" async=""></script><script src="/framework-762c3e0db5757dd301d6.js" async=""></script><script src="/webpack-runtime-ce3e8db7a0ca99c66521.js" async=""></script></body></html>